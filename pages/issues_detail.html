<template>
	<t-report class="max-w-[1440px] relative left-0 right-0 m-auto">
{{ filters }}
{{ context }}
{{ parent_context_url }}
		<!-- Filters Left Start -->
        <div slot="filters" class="flex justify-between w-full">
            <t-container gap-x="2">

                <t-navigation-dropdown label="Select Report Name" />

                <div class="w-[1px] md:relative absolute hidden md:block left-1 bg-[#D3D3D9] h-[28px]"></div>
            
                <div v-if="whoami && whoami.custom_attributes.snyk_user_reports_group_ids.length > 1">
                <!-- only in dev in Topcoat--> 
                    <t-select t-layer="filter_group" t-filter:dropdown="groups" label="Groups" item-label="Groups" />
                    <t-multi-selector is-searchable t-layer="filter_orgs" t-filter:selected_items="orgs"
                    label="Organizations" />
                </div> 
                <div v-else-if="whoami && whoami.custom_attributes.snyk_user_reports_group_ids.length == 1">
                <!-- iframe: selected a group so it should only be org --> 
                    <t-multi-selector is-searchable t-layer="filter_orgs" t-filter:selected_items="orgs"
                    label="Organizations" />
                </div> 
                <div v-else >
                <!-- iframe: no filter because they picked one org --> 
                </div>

                <t-multi-selector t-layer="filter_product_name" t-filter:selected_items="product_name" label="Products" />

                <t-filter-group label="More Filters" max-height="400px">
                    <t-multi-selector is-expanded t-layer="filter_autofixable" t-filter:selected_items="autofixable" item-label="Auto Fixable" /> 
                    <t-tags-input is-single-tag t-layer='filter_cve' item-label="CVE" t-filter:selected_items="cve" :is-label-capitalized="true" /> 
                    <t-tags-input is-single-tag t-layer='filter_cwe' item-label="CWE" t-filter:selected_items="cwe" :is-label-capitalized="true" />  
                    <t-multi-selector is-expanded t-layer="filter_exploit_maturity" t-filter:selected_items="exploit_maturity" item-label="Exploit Maturity" />
                    <t-date-picker t-layer="filter_calendar_introduced" t-filter:start_date="introduced_start" t-filter:end_date="introduced_end" t-filter:date_preset="range_preset" date-format="YYYY-MM-DD" item-label="Introduced Date" />
                    <t-multi-selector is-expanded t-layer="filter_issue_severity" t-filter:selected_items="issue_severity" item-label="Issue Severity" />
                    <t-multi-selector is-expanded default-value="Open" t-layer="filter_issue_status" t-filter:selected_items="issue_status" item-label="Issue Status" />
                    <t-multi-selector is-expanded t-layer="filter_issue_type" t-filter:selected_items="issue_type" item-label="Issue Type" />
                    <t-date-picker t-layer="filter_calendar_last_introduced" t-filter:start_date="last_introduced_start" t-filter:end_date="last_introduced_end" t-filter:date_preset="range_preset" date-format="YYYY-MM-DD" item-label="Last Introduced Date" />
                    <t-date-picker t-layer="filter_calendar_last_disappeared" t-filter:start_date="last_disappeared_start" t-filter:end_date="last_disappeared_end" t-filter:date_preset="range_preset" date-format="YYYY-MM-DD" item-label="Last Resolved Date" />
                    <!-- <t-range-input t-layer="filter_priority_score" t-filter:min="min" t-filter:max="max" t-min-column="MIN" t-max-column="MAX" item-label="Priority Score" /> -->
                    <t-tags-input is-single-tag t-layer='filter_project_criticality' item-label="Project Criticality" t-filter:selected_items="criticality" :is-label-capitalized="true" /> 
                    <t-tags-input is-single-tag t-layer='filter_project_environment' item-label="Project Environment" t-filter:selected_items="environment" :is-label-capitalized="true" /> 
                    <t-tags-input is-single-tag t-layer='filter_project_lifecycle' item-label="Project Lifecycle" t-filter:selected_items="lifecycle" :is-label-capitalized="true" /> 
                    <t-multi-selector is-expanded t-layer="filter_project_name" t-filter:selected_items="project_name" item-label="Project Name" is-searchable />
                    <t-tags-input t-layer='filter_tags' item-label="Project Tags" t-filter:selected_items="tags" :is-label-capitalized="true" />
                    <t-multi-selector is-expanded t-layer="filter_project_type" t-filter:selected_items="project_type" item-label="Project Type" />
                    <t-multi-selector is-expanded t-layer="filter_reachability" t-filter:selected_items="reachability" item-label="Reachability" />
                </t-filter-group>
            </t-container>
		    <!-- Filters Left End -->

		    <!-- Filters Right Start -->
            <t-container gap-x="2">
                <t-pdf-export />
            </t-container>
        </div>
		<!-- Filters Right End -->

		<!-- Mid Section Start -->



		<!-- Mid Section End -->

		<t-container class="flex flex-wrap justify-between" gap-y="2">
			<h2 class="text-xl	font-normal">Issue details</h2>
			<t-container gap-x="2" gap-y="2" class="flex-wrap">
				<!-- The t-select (below) is commented out, because it is not doing anything -->
				<!-- it will be uncommented, when the grouped version of the table is ready -->
				<!-- The reason is so that there are no un-responsive elements on the page for our demos -->
				<!-- <t-select t-layer="table_group_by" t-filter:dropdown="group_by" label="Group by" item-label="test"/> -->
				<!-- <t-csv-export t-layer="issue_table" /> -->
			</t-container>
		</t-container>

		<!-- Layers Start -->
    <!-- TODO: reinstate the ungrouped issues table -->
            <!-- <TTable 
                  :can-search="false" 
                  t-layer="seed_grouped_issues" 
                  :is-header-fixed="true" 
                  :can-sort="false"
                  canCollapseDetailRows
                  :exludeFromColumns="['URL','CVE','PROBLEM_ID', 'ORIGINAL_SEVERITY', 'PACKAGE', 'ISSUE_TYPE']"
            >
                  <template v-slot:detail_row_slot="row">
                        <h1>COMING SOON... PROJECT DATA</h1>
                  </template> -->

		<!-- Layers End -->

	</t-report>
</template>
